
# 카카오헬스케어-케어챗

카카오헬스케어-케어챗은 바닐라 JavaScript와 Node.js의 Express 서버를 사용하여 구현한 프로젝트입니다. 
사용자가 웹 에디터(CKEditor)를 이용해 메뉴 추가 삭제 및 콘텐츠 작성 및 편집을 할 수 있습니다.
DB를 사용하지 않고, JSON 파일을 통해 메뉴 및 콘텐츠 데이터를 관리하는 형태로 구현되어 있습니다.
CKEditor는 기본적으로 저장된 HTML 콘텐츠에 스타일 정보를 포함시키지 않기 때문에 커스텀 css 지정이 가능 합니다. 

 - 코드블록은 `highlight.js` 사용 예정

## 프로젝트 구조

```plaintext
project-root/
│
├── public/                    # 정적 파일 디렉터리
│   ├── css/                   # 스타일시트 파일
│   ├── data/                  # 데이터 저장용 JSON 파일 (메뉴 및 컨텐츠 데이터 포함)
│   ├── images/                # 이미지 파일
│   ├── libs/                  # 서드파티 라이브러리
│   └── js/                    # JavaScript 파일
│       ├── contentLoader.js       // 콘텐츠 로딩 및 메뉴 렌더링
│       ├── editorConfig.js        // CKEditor 설정 및 초기화
│       ├── editorControls.js      // 에디터 제어 (편집 및 저장 등)
│       ├── modalManager.js        // 모달 관련 기능
│       └── utils.js               // 공통 유틸리티 함수
│
├── views/                     # HTML 파일 (템플릿)
│   ├── index.html             # 메인 페이지
│   └── admin.html             # 에디트 페이지
│
│
├── uploads/                   # 업로드된 이미지 저장 디렉터리 (서버 내부 관리)
│   └── temp/                  # 임시 파일이나 미처리 이미지 저장 (필요 시 추가)
│
├── routes/                    # Express 라우트 관리
│   ├── index.js               # 기본 라우트 설정
│   ├── api.js                 # API 엔드포인트
│   └── upload.js              # 이미지 업로드 라우트
│
├── server.js                  # Express 서버 설정
├── package.json               # 프로젝트 설정 및 의존성 목록
└── README.md                  # 프로젝트 설명
```

## 주요 기능
- **메뉴 및 콘텐츠 관리**: JSON 파일을 사용해 DB 없이 메뉴와 콘텐츠를 추가, 수정, 삭제할 수 있습니다.
- **CKEditor 연동**: 웹 에디터(CKEditor)를 사용하여 실시간으로 콘텐츠를 작성 및 수정합니다.
- **미리보기 및 실시간 확인**: 콘텐츠 편집 후 즉시 결과를 확인할 수 있습니다.
- **정적 파일 관리**: 로컬 이미지를 불러와 콘텐츠에 쉽게 삽입할 수 있습니다.
- **커스텀 css**: 저장된 html 태그에 커스텀 스타일을 입힐 수 있습니다.  

## 설치 및 실행 방법

### 사전 요구 사항
- [Node.js](https://nodejs.org/) 설치 (최소 버전 14)
- npm 또는 yarn 패키지 관리자

### 설치

1. 저장소 클론
   ```bash
   git clone http://192.168.0.232:53080/kakao/HealthCareChat
   cd HealthCareChat
   ```

2. 패키지 설치
   ```bash
   npm install
   ```
   
3. 개발 서버 실행
   ```bash
   npm start
   ```
   개발 서버는 기본적으로 `http://localhost:3000`에서 실행됩니다.


## API

### 콘텐츠 관리
- **POST /api/content**: `href` 경로와 `content` 데이터를 받아, JSON 파일(`content.json`)에서 해당 항목의 콘텐츠를 업데이트합니다. 콘텐츠가 업데이트되면 `"Content updated successfully."` 메시지를 반환합니다.
  - 요청 본문 예시:
    ```json
    {
      "href": "/example-path",
      "content": "새로운 콘텐츠 내용"
    }
    ```
  - 응답 예시:
    ```json
    {
      "message": "Content updated successfully."
    }
    ```
  
### 이미지 업로드
- **POST /api/upload**: 이미지 파일을 업로드합니다. 성공적으로 업로드되면 이미지 파일의 URL을 반환합니다.
  - 요청 형식: multipart/form-data, `upload` 필드에 파일 포함
  - 응답 예시:
    ```json
    {
      "url": "http://localhost:3000/uploads/파일명"
    }
    ```

### 페이지 라우팅
- **GET /admin**: 관리자 페이지(`admin.html`)를 반환합니다.
- **GET /viewer**: 뷰어 페이지(`viewer.html`)를 반환합니다.

## 사용 방법

1. **메인 페이지**: `index.html`에 접근하여 사이트를 탐색할 수 있습니다.
2. **에디트 페이지**: `admin.html`에 접근해 CKEditor를 사용하여 콘텐츠를 작성 및 수정할 수 있습니다.
3. **JSON 데이터 관리**: 콘텐츠와 메뉴는 `data/content.json` 파일에 저장됩니다. 에디터에서 수정한 내용은 이 파일에 반영됩니다.

## 참고 자료
- [CKEditor Documentation](https://ckeditor.com/docs/)
- [Express.js Documentation](https://expressjs.com/)


---
---


## 추가 정보

이 프로젝트는 데이터베이스 없이 JSON 파일을 통해 데이터를 관리하기 때문에, 소규모 프로젝트나 단순한 웹사이트에 적합합니다. 

JSON 파일을 통한 데이터 관리는 간단하고 빠르지만, `데이터가 많아지거나 동시 접속자가 많아질 경우 성능 문제가 발생할 수 있습니다.` 데이터가 중요하거나 규모가 큰 프로젝트에서는 일반적인 데이터베이스를 사용하는 것이 좋습니다.

이 방식의 구체적 장점과 단점은 다음과 같습니다.

### 장점

1. **간편한 설정**:
   - 별도의 데이터베이스 설치나 설정이 필요 없으므로 초기 설정이 간단합니다.
   - 단일 JSON 파일을 통해 데이터를 다루기 때문에, 프로젝트 파일만으로도 데이터베이스 역할을 할 수 있습니다.

2. **간단한 데이터 관리**:
   - 파일 형식이 단순하기 때문에, JSON 파일을 열어 데이터를 쉽게 읽고 수정할 수 있습니다.
   - 파일 접근만으로 데이터를 저장하고 불러올 수 있으므로, 파일 입출력 코드만 있으면 간단하게 CRUD(생성, 읽기, 갱신, 삭제) 작업이 가능합니다.

3. **작은 프로젝트에 적합**:
   - 소규모 사이트나 관리 데이터가 많지 않은 프로젝트에 적합합니다.
   - JSON 파일로 데이터를 저장해 두면 코드와 데이터가 한 곳에 있기 때문에 관리하기 편리합니다.

### 단점

1. **동시성 문제**:
   - JSON 파일은 파일 시스템을 통해 접근하므로 여러 사용자가 동시에 데이터를 수정하거나 저장할 경우 충돌이 발생할 수 있습니다.
   - 특히 트래픽이 많거나 데이터 접근이 빈번한 경우 데이터 손상 가능성이 있습니다.

2. **성능 한계**:
   - 데이터 양이 많아지면 파일 읽기와 쓰기 성능이 저하됩니다. 모든 데이터를 한 번에 로드하는 JSON 파일 방식은 대용량 데이터를 다루기엔 비효율적입니다.
   - 데이터 양이 적은 경우에는 큰 문제가 되지 않지만, 많은 데이터를 다룰 때는 데이터베이스보다 느립니다.

3. **백업 및 복구 어려움**:
   - 데이터베이스는 일반적으로 백업과 복구 기능을 제공합니다. 하지만 JSON 파일 방식은 이러한 기능이 없기 때문에 수동으로 백업 및 복구를 해야 합니다.

4. **보안**:
   - JSON 파일은 쉽게 수정할 수 있기 때문에, 데이터가 중요한 경우에는 JSON 파일 방식이 보안에 취약할 수 있습니다. 서버 측 권한 설정을 통해 보호할 필요가 있습니다.

### 요약

JSON 파일을 통한 데이터 관리는 간단하고 빠르지만, **데이터가 많아지거나 동시 접속자가 많아질 경우** 성능 문제가 발생할 수 있습니다. 단순한 웹사이트나 테스트 용도로는 유용하지만, **데이터가 중요하거나 규모가 큰 프로젝트**에서는 일반적인 데이터베이스(MySQL, MongoDB 등)를 사용하는 것이 좋습니다. 

> => JSON 파일을 사용해 데이터를 관리하려면, 백업 주기 및 동시성 관리 방안에 대해 추가적으로 고려하는 것이 좋음. 
---

### 해당 방식의 단점에 대한 구체적 예시와 해결 방안
JSON 파일을 데이터 저장소로 사용할 때 발생할 수 있는 주요 문제들은 **동시성 문제**, **성능 한계**, **백업 및 복구 어려움**, 그리고 **보안 문제**가 있습니다. 각각에 대한 구체적인 예시와 해결 방안에 대해 하단에 정리해 두었습니다. 

---

#### 1. 동시성 문제

##### 설명
동시성 문제는 여러 사용자가 동시에 JSON 파일에 접근해 데이터를 수정하거나 저장하려고 할 때 발생하는 문제입니다. JSON 파일을 사용하면 파일을 한 번에 하나의 요청만이 수정할 수 있습니다. 만약 여러 요청이 동시에 파일에 접근하려 하면 다음과 같은 상황이 발생할 수 있습니다.

##### 예시
1. **충돌**: 예를 들어, 사용자가 동시에 같은 JSON 파일에 접근하여 데이터를 수정한다고 가정해봅시다. 사용자 A가 JSON 파일을 읽고 수정한 후 저장하는 도중, 사용자 B도 같은 파일을 수정하고자 할 수 있습니다. 이 경우 사용자 B가 데이터를 저장하면 사용자 A의 변경사항이 덮어씌워지거나 사라질 수 있습니다.
   
2. **데이터 손상**: 동시에 수정 요청이 들어오면, 파일 입출력 과정에서 충돌이 발생해 파일이 손상되거나 제대로 저장되지 않을 가능성이 있습니다. 파일이 제대로 저장되지 않으면 파일의 형식이 깨져 이후의 요청에서 JSON 파일을 정상적으로 불러올 수 없게 됩니다.

##### 해결 방안
- **파일 잠금 (File Locking)**: 수정 중인 파일에 잠금을 설정하여 한 번에 하나의 요청만 파일을 수정할 수 있게 합니다. 그러나 이는 구현이 복잡하고 트래픽이 많을 때 성능 저하가 발생할 수 있습니다.
- **큐 사용**: 요청을 순차적으로 처리하는 큐를 만들어, 하나의 요청이 완료된 후 다음 요청이 처리되도록 합니다.
- **데이터베이스로 전환**: JSON 파일이 아닌 동시성 처리가 기본적으로 잘 되는 데이터베이스를 사용하는 것이 가장 확실한 해결책입니다.

---

#### 2. 성능 한계

##### 설명
JSON 파일을 사용해 데이터를 관리하면 모든 데이터를 파일 하나에 저장하고 이를 불러와 처리하게 됩니다. 데이터 양이 많아지면 파일의 크기도 커지고, 파일을 읽거나 쓸 때 시간이 오래 걸릴 수 있습니다. 특히, 데이터가 증가할수록 JSON 파일을 로드하고 전체 데이터를 메모리에 저장하는 방식은 효율적이지 않습니다.

##### 예시
- **읽기 속도 저하**: 10MB 크기의 JSON 파일을 서버가 계속해서 읽어와야 한다고 가정해봅시다. 파일을 메모리에 로드하고 필요한 데이터를 찾는 데 시간이 오래 걸리게 됩니다.
- **쓰기 속도 저하**: 10MB 파일을 불러와 데이터를 수정한 뒤 다시 파일로 저장해야 할 때마다 파일 전체를 새로 작성해야 하므로 속도가 느려집니다.
- **메모리 사용량 증가**: JSON 파일을 처리하기 위해서는 전체 파일을 메모리에 로드해야 하므로 데이터가 커질수록 메모리 사용량도 늘어납니다.

##### 해결 방안
- **파일을 작은 조각으로 분할**: 데이터가 많은 경우 여러 JSON 파일로 분할하여 관리하면 성능 저하를 조금 완화할 수 있습니다.
- **데이터베이스 사용**: 대용량 데이터를 효율적으로 처리할 수 있는 데이터베이스로 전환하면 성능 문제가 해결됩니다.

---

#### 3. 백업 및 복구의 어려움

##### 설명
데이터베이스는 대부분 자동 백업 기능과 복구 기능을 제공하여 손상된 데이터를 쉽게 복원할 수 있지만, JSON 파일은 별도의 관리 도구가 없기 때문에 수동으로 백업과 복구를 해야 합니다. 또한, 파일이 손상되었을 때 이를 복구할 수 있는 시스템이 부족하여 데이터 손실 위험이 큽니다.

##### 예시
- **백업 과정**: JSON 파일을 수동으로 복사하여 백업해야 하므로 자동화되지 않아 관리가 어렵고, 백업본이 최신 상태가 아닐 수 있습니다.
- **복구 과정**: JSON 파일이 손상되거나 누락된 경우, 백업본을 수동으로 찾아 복구해야 하며, 최신 데이터가 복구되지 않을 가능성이 있습니다.

##### 해결 방안
- **정기적인 백업 스크립트**: JSON 파일을 정기적으로 복사하여 백업본을 만들어두는 스크립트를 작성하여 백업 주기를 자동화할 수 있습니다.
- **데이터베이스 사용**: 자동 백업 및 복구가 필요한 경우 데이터베이스로 전환하는 것이 훨씬 안전하고 관리가 쉽습니다.

---

#### 4. 보안 문제

##### 설명
JSON 파일은 서버의 파일 시스템에 직접 저장되는 형태로, 직접 파일에 접근하여 데이터를 변경하는 것이 쉬워 보안에 취약할 수 있습니다. 파일에 직접 접근할 수 있으면 데이터를 쉽게 조작할 수 있어 중요한 정보를 JSON 파일로 다루는 것은 위험할 수 있습니다.

##### 예시
- **파일 무단 수정**: JSON 파일이 서버 파일 시스템에 저장되므로, 서버 권한 설정이 취약할 경우 외부에서 무단으로 파일을 수정할 수 있습니다.
- **민감 데이터 저장의 위험성**: 패스워드, 개인정보 같은 민감한 데이터를 JSON 파일에 저장하게 되면 파일 자체를 훔쳐가는 단순한 접근만으로 정보가 유출될 수 있습니다.

##### 해결 방안
- **서버 파일 권한 관리**: JSON 파일이 저장된 디렉터리의 접근 권한을 설정하고, 서버 파일 시스템에 대한 외부 접근을 제한합니다.
- **암호화**: 민감한 데이터가 JSON 파일에 저장될 때는 암호화를 적용하여 보안을 강화할 수 있습니다.
- **데이터베이스 사용**: 보안이 중요한 경우 권한 제어와 암호화가 잘 적용된 데이터베이스를 사용하는 것이 안전합니다.

---

#### 요약
JSON 파일은 설정이 간단하고 소규모 프로젝트에는 적합하지만, **동시성, 성능, 백업, 보안** 측면에서 확장성과 신뢰성이 떨어집니다. 작은 프로젝트나 개인 용도로는 유용할 수 있으나, 트래픽이 많거나 보안이 중요한 경우에는 **데이터베이스로의 전환**을 고려하는 것이 좋습니다.

